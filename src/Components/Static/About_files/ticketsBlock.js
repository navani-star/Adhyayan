(function(modules){function webpackJsonpCallback(data){var chunkIds=data[0];var moreModules=data[1];var executeModules=data[2];var moduleId,chunkId,i=0,resolves=[];for(;i<chunkIds.length;i++){chunkId=chunkIds[i];if(Object.prototype.hasOwnProperty.call(installedChunks,chunkId)&&installedChunks[chunkId]){resolves.push(installedChunks[chunkId][0])}installedChunks[chunkId]=0}for(moduleId in moreModules){if(Object.prototype.hasOwnProperty.call(moreModules,moduleId)){modules[moduleId]=moreModules[moduleId]}}if(parentJsonpFunction)parentJsonpFunction(data);while(resolves.length){resolves.shift()()}deferredModules.push.apply(deferredModules,executeModules||[]);return checkDeferredModules()};function checkDeferredModules(){var result;for(var i=0;i<deferredModules.length;i++){var deferredModule=deferredModules[i];var fulfilled=!0;for(var j=1;j<deferredModule.length;j++){var depId=deferredModule[j];if(installedChunks[depId]!==0)fulfilled=!1}if(fulfilled){deferredModules.splice(i--,1);result=__webpack_require__(__webpack_require__.s=deferredModule[0])}}return result}var installedModules={};var installedChunks={9:0};var deferredModules=[];function __webpack_require__(moduleId){if(installedModules[moduleId]){return installedModules[moduleId].exports}var module=installedModules[moduleId]={i:moduleId,l:!1,exports:{}};modules[moduleId].call(module.exports,module,module.exports,__webpack_require__);module.l=!0;return module.exports}__webpack_require__.m=modules;__webpack_require__.c=installedModules;__webpack_require__.d=function(exports,name,getter){if(!__webpack_require__.o(exports,name)){Object.defineProperty(exports,name,{enumerable:!0,get:getter})}};__webpack_require__.r=function(exports){if(typeof Symbol!=='undefined'&&Symbol.toStringTag){Object.defineProperty(exports,Symbol.toStringTag,{value:'Module'})}Object.defineProperty(exports,'__esModule',{value:!0})};__webpack_require__.t=function(value,mode){if(mode&1)value=__webpack_require__(value);if(mode&8)return value;if((mode&4)&&typeof value==='object'&&value&&value.__esModule)return value;var ns=Object.create(null);__webpack_require__.r(ns);Object.defineProperty(ns,'default',{enumerable:!0,value:value});if(mode&2&&typeof value!='string')for(var key in value)__webpack_require__.d(ns,key,function(key){return value[key]}.bind(null,key));return ns};__webpack_require__.n=function(module){var getter=module&&module.__esModule?function getDefault(){return module['default']}:function getModuleExports(){return module};__webpack_require__.d(getter,'a',getter);return getter};__webpack_require__.o=function(object,property){return Object.prototype.hasOwnProperty.call(object,property)};__webpack_require__.p="";var jsonpArray=window.webpackJsonp=window.webpackJsonp||[];var oldJsonpFunction=jsonpArray.push.bind(jsonpArray);jsonpArray.push=webpackJsonpCallback;jsonpArray=jsonpArray.slice();for(var i=0;i<jsonpArray.length;i++)webpackJsonpCallback(jsonpArray[i]);var parentJsonpFunction=oldJsonpFunction;deferredModules.push(["jL1e",0]);return checkDeferredModules()})({"3Fbz":(function(module,exports,__webpack_require__){}),"Almt":(function(module,exports){module.exports=tec.tickets.seating.currency}),"KO+N":(function(module,exports){module.exports=tec.tickets.seating.frontend.session}),"MsaN":(function(module,exports){module.exports=tec.tickets.seating.utils}),"g56x":(function(module,exports){module.exports=wp.hooks}),"jL1e":(function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);__webpack_require__.d(__webpack_exports__,"bootstrapIframe",function(){return bootstrapIframe});__webpack_require__.d(__webpack_exports__,"cancelReservations",function(){return cancelReservations});__webpack_require__.d(__webpack_exports__,"closeModal",function(){return closeModal});__webpack_require__.d(__webpack_exports__,"addModalEventListeners",function(){return addModalEventListeners});var defineProperty=__webpack_require__("lSNA");var defineProperty_default=__webpack_require__.n(defineProperty);var asyncToGenerator=__webpack_require__("yXPU");var asyncToGenerator_default=__webpack_require__.n(asyncToGenerator);var style=__webpack_require__("3Fbz");var external_tec_tickets_seating_service_iframe_=__webpack_require__("pJv/");var external_tec_tickets_seating_service_api_=__webpack_require__("wRIV");var external_tec_tickets_seating_utils_=__webpack_require__("MsaN");function TicketRow(props){return Object(external_tec_tickets_seating_utils_.createHtmlComponentFromTemplateString)(`<div class="tec-tickets-seating__ticket-row"
			data-seat-type-id="{seatTypeId}"
			data-ticket-id="{ticketId}"
			data-price="{price}"
			data-seat-label="{seatLabel}"
			>
			<div class="tec-tickets-seating__seat-color" style="background: {color}"></div>

			<div class="tec-tickets-seating__label">
				<div class="tec-tickets-seating__ticket-name">{ticketName}</div>
				<div class="tec-tickets-seating__seat-label">{seatLabel}</div>
			</div>

			<div class="tec-tickets-seating__ticket-price">{formattedPrice}</div>
		</div>`,props)}
var _window,_window$tec,_window$tec$tickets,_window$tec$tickets$s,_window$tec$tickets$s2;const localizedData=(_window=window)===null||_window===void 0?void 0:(_window$tec=_window.tec)===null||_window$tec===void 0?void 0:(_window$tec$tickets=_window$tec.tickets)===null||_window$tec$tickets===void 0?void 0:(_window$tec$tickets$s=_window$tec$tickets.seating)===null||_window$tec$tickets$s===void 0?void 0:(_window$tec$tickets$s2=_window$tec$tickets$s.frontend)===null||_window$tec$tickets$s2===void 0?void 0:_window$tec$tickets$s2.ticketsBlock;var external_tec_tickets_seating_currency_=__webpack_require__("Almt");var external_wp_hooks_=__webpack_require__("g56x");var external_tec_tickets_seating_frontend_session_=__webpack_require__("KO+N");function checkoutWithTicketsCommerce(_x){return _checkoutWithTicketsCommerce.apply(this,arguments)}
function _checkoutWithTicketsCommerce(){_checkoutWithTicketsCommerce=asyncToGenerator_default()(function*(data){const searchParams=new URLSearchParams(window.location.search);searchParams.append('tec-tc-cart','redirect');const cartUrl=`${window.location.origin}${window.location.pathname}?${searchParams}`;const response=yield fetch(cartUrl,{method:'POST',body:data});if(response.ok&&response.url){Object(external_tec_tickets_seating_frontend_session_.setIsInterruptable)(!1);window.location.href=response.url;return!0}
return!1});return _checkoutWithTicketsCommerce.apply(this,arguments)}
function getCheckoutHandlerForProvider(provider){let checkoutHandler;switch(provider){case 'TECTicketsCommerceModule':case 'TEC\\Tickets\\Commerce\\Module':checkoutHandler=checkoutWithTicketsCommerce;break;default:checkoutHandler=null;break}
checkoutHandler=Object(external_wp_hooks_.applyFilters)('tec.tickets.seating.checkoutHandler',checkoutHandler,provider);return checkoutHandler}
const ticketIds=Object.values(localizedData.seatTypeMap).reduce((acc,seatType)=>{acc.push(...seatType.tickets.map(ticket=>ticket.ticketId));return acc},[]);function filterGeTickets(){return ticketIds}
Object(external_wp_hooks_.addFilter)('tec.tickets.tickets-block.getTickets','tec.tickets.seating',filterGeTickets);function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);enumerableOnly&&(symbols=symbols.filter(function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable})),keys.push.apply(keys,symbols)}return keys}
function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?ownKeys(Object(source),!0).forEach(function(key){defineProperty_default()(target,key,source[key])}):Object.getOwnPropertyDescriptors?Object.defineProperties(target,Object.getOwnPropertyDescriptors(source)):ownKeys(Object(source)).forEach(function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))})}return target}
const{objectName,seatTypeMap,labels,providerClass,postId,ajaxUrl,ajaxNonce,ACTION_POST_RESERVATIONS,ACTION_CLEAR_RESERVATIONS}=localizedData;let totalPriceElement=null;let totalTicketsElement=null;let emptyTicketMessageElement=null;const confirmSelector='.tec-tickets-seating__modal .tec-tickets-seating__sidebar-control--confirm';const tickets=Object.values(seatTypeMap).reduce((map,seatType)=>{seatType.tickets.forEach(ticket=>{map[ticket.ticketId]=ticket});return map},{});let currentController=new AbortController();let shouldCancelReservations=!0;function formatTicketNumber(value){return value===1?labels.oneTicket:labels.multipleTickets.replace('{count}',value)}
function enableCheckout(parentElement){parentElement=parentElement||document;Array.from(parentElement.querySelectorAll(confirmSelector)).forEach(confirm=>{confirm.disabled=!1})}
function disableCheckout(parentElement){parentElement=parentElement||document;Array.from(parentElement.querySelectorAll(confirmSelector)).forEach(confirm=>{confirm.disabled=!0})}
function updateTotals(parentElement){parentElement=parentElement||document;const rows=Array.from(parentElement.querySelectorAll('.tec-tickets-seating__ticket-row'));if(rows.length){enableCheckout(parentElement)}else{disableCheckout(parentElement)}
totalPriceElement.innerText=Object(external_tec_tickets_seating_currency_.formatWithCurrency)(rows.reduce(function(acc,row){return acc+Number(row.dataset.price)},0));totalTicketsElement.innerText=formatTicketNumber(rows.length);const totalsWrapper=parentElement.querySelector('.tec-tickets-seating__total');if(rows.length===0){totalsWrapper.classList.add('tec-tickets-seating__total-hidden')}else{totalsWrapper.classList.remove('tec-tickets-seating__total-hidden')}}
function addTicketToSelection(parentElement,props){var _tickets$props$ticket;parentElement=parentElement||document;const ticketPrice=(tickets===null||tickets===void 0?void 0:(_tickets$props$ticket=tickets[props.ticketId])===null||_tickets$props$ticket===void 0?void 0:_tickets$props$ticket.price)||null;const ticketName=(tickets===null||tickets===void 0?void 0:tickets[props.ticketId].name)||null;if(!(ticketPrice&&ticketName)){return}
const ticketRowProps={seatTypeId:props.seatTypeId,ticketId:props.ticketId,price:ticketPrice,color:props.seatColor,ticketName,seatLabel:props.seatLabel,formattedPrice:Object(external_tec_tickets_seating_currency_.formatWithCurrency)(ticketPrice)};parentElement.querySelector('.tec-tickets-seating__ticket-rows').appendChild(TicketRow(ticketRowProps))}
function postReservationsToBackend(_x){return _postReservationsToBackend.apply(this,arguments)}function _postReservationsToBackend(){_postReservationsToBackend=asyncToGenerator_default()(function*(reservations){yield currentController.abort('New reservations data');const newController=new AbortController();const requestUrl=new URL(ajaxUrl);requestUrl.searchParams.set('_ajax_nonce',ajaxNonce);requestUrl.searchParams.set('action',ACTION_POST_RESERVATIONS);requestUrl.searchParams.set('postId',postId);let response=null;response=yield fetch(requestUrl.toString(),{method:'POST',signal:newController.signal,body:JSON.stringify({token:Object(external_tec_tickets_seating_service_api_.getToken)(),reservations})});currentController=newController;if(!response.ok){console.error('Failed to post reservations to backend');return!1}
return!0});return _postReservationsToBackend.apply(this,arguments)}
function updateTicketsSelection(parentElement,items){parentElement=parentElement||document;parentElement.querySelector('.tec-tickets-seating__ticket-rows').innerHTML='';items.forEach(item=>{addTicketToSelection(parentElement,item)});const reservations=items.reduce((acc,item)=>{acc[item.ticketId]=acc[item.ticketId]||[];acc[item.ticketId].push({reservationId:item.reservationId,seatTypeId:item.seatTypeId,seatLabel:item.seatLabel});return acc},{});postReservationsToBackend(reservations);updateTotals(parentElement)}
function updateEmptyTicketsMessage(ticketCount){if(!ticketCount){emptyTicketMessageElement.classList.remove('tec-tickets-seating__empty-tickets-message-hidden')}else{emptyTicketMessageElement.classList.add('tec-tickets-seating__empty-tickets-message-hidden')}}
function validateSelectionItemFromService(item){return item.seatTypeId&&item.ticketId&&item.seatColor&&item.seatLabel&&item.reservationId}
function registerActions(iframe){Object(external_tec_tickets_seating_service_api_.registerAction)(external_tec_tickets_seating_service_api_.INBOUND_APP_READY_FOR_DATA,()=>{Object(external_tec_tickets_seating_service_api_.removeAction)(external_tec_tickets_seating_service_api_.INBOUND_APP_READY_FOR_DATA);Object(external_tec_tickets_seating_service_api_.sendPostMessage)(iframe,external_tec_tickets_seating_service_api_.OUTBOUND_SEAT_TYPE_TICKETS,seatTypeMap)});Object(external_tec_tickets_seating_service_api_.registerAction)(external_tec_tickets_seating_service_api_.INBOUND_SEATS_SELECTED,items=>{updateTicketsSelection(iframe.closest('.event-tickets'),items.filter(item=>validateSelectionItemFromService(item)));updateEmptyTicketsMessage(items.length)})}
function toggleMobileSidebarOpen(dom){dom=dom||document;dom.querySelector('.tec-tickets-seating__sidebar-arrow').addEventListener('click',()=>{const sidebar=dom.querySelector('.tec-tickets-seating__modal-sidebar');if(sidebar){sidebar.classList.toggle('tec-tickets-seating__modal-sidebar-open')}})}
function setupMobileTicketsDrawer(dom){dom=dom||document;if(window&&window.innerWidth<=960){const iframeContainer=dom.querySelector('.tec-tickets-seating__iframe-container');iframeContainer.style.height=iframeContainer.clientHeight+'px';iframeContainer.style.maxHeight=iframeContainer.clientHeight+'px';const sidebarContainer=dom.querySelector('.tec-tickets-seating__modal-sidebar_container');sidebarContainer.style.height=sidebarContainer.clientHeight+'px';sidebarContainer.style.minHeight=sidebarContainer.clientHeight+'px';sidebarContainer.style.maxHeight=sidebarContainer.clientHeight+'px';const sidebar=sidebarContainer.querySelector('.tec-tickets-seating__modal-sidebar');if(sidebar){sidebar.style.position='absolute'}}}
function bootstrapIframe(_x2){return _bootstrapIframe.apply(this,arguments)}
function _bootstrapIframe(){_bootstrapIframe=asyncToGenerator_default()(function*(dom){dom=dom||document;const iframe=Object(external_tec_tickets_seating_service_iframe_.getIframeElement)(dom);if(!iframe){console.error('Iframe element not found.');return!1}
registerActions(iframe);yield Object(external_tec_tickets_seating_service_iframe_.initServiceIframe)(iframe);toggleMobileSidebarOpen(dom);setupMobileTicketsDrawer(dom);totalPriceElement=dom.querySelector('.tec-tickets-seating__total-price');totalTicketsElement=dom.querySelector('.tec-tickets-seating__total-text');emptyTicketMessageElement=dom.querySelector('.tec-tickets-seating__empty-tickets-message')});return _bootstrapIframe.apply(this,arguments)}
function cancelReservationsOnBackend(){return _cancelReservationsOnBackend.apply(this,arguments)}function _cancelReservationsOnBackend(){_cancelReservationsOnBackend=asyncToGenerator_default()(function*(){yield currentController.abort('New reservations data');const newController=new AbortController();const requestUrl=new URL(ajaxUrl);requestUrl.searchParams.set('_ajax_nonce',ajaxNonce);requestUrl.searchParams.set('action',ACTION_CLEAR_RESERVATIONS);requestUrl.searchParams.set('token',Object(external_tec_tickets_seating_service_api_.getToken)());requestUrl.searchParams.set('postId',postId);const response=yield fetch(requestUrl.toString(),{signal:newController.signal,method:'POST'});currentController=newController;if(!response.ok){console.error('Failed to remove reservations from backend');return!1}
return!0});return _cancelReservationsOnBackend.apply(this,arguments)}
function clearTicketSelection(){Array.from(document.querySelectorAll('.tec-tickets-seating__ticket-rows .tec-tickets-seating__ticket-row')).forEach(row=>{row.remove()})}
function cancelReservations(_x3){return _cancelReservations.apply(this,arguments)}
function _cancelReservations(){_cancelReservations=asyncToGenerator_default()(function*(dialogElement){if(!shouldCancelReservations){return}
const iframe=dialogElement?dialogElement.querySelector('.tec-tickets-seating__iframe-container iframe.tec-tickets-seating__iframe'):null;if(iframe){Object(external_tec_tickets_seating_service_api_.sendPostMessage)(iframe,external_tec_tickets_seating_service_api_.OUTBOUND_REMOVE_RESERVATIONS)}
yield cancelReservationsOnBackend();Object(external_tec_tickets_seating_frontend_session_.reset)();clearTicketSelection()});return _cancelReservations.apply(this,arguments)}
function closeModal(){var _window;const modal=(_window=window)===null||_window===void 0?void 0:_window[objectName];if(!modal){return}
modal._hide()}
function readTicketsFromSelection(){const ticketsFromSelection=Array.from(document.querySelectorAll('.tec-tickets-seating__ticket-rows .tec-tickets-seating__ticket-row')).reduce((acc,row)=>{const ticketId=row.dataset.ticketId;if(!(acc!==null&&acc!==void 0&&acc[ticketId])){acc[ticketId]={ticket_id:ticketId,quantity:1,optout:'1',seat_labels:[row.dataset.seatLabel]}}else{acc[ticketId].quantity++;acc[ticketId].seat_labels=[...acc[ticketId].seat_labels,row.dataset.seatLabel]}
return acc},{});return Object.values(ticketsFromSelection)}
function proceedToCheckout(){return _proceedToCheckout.apply(this,arguments)}function _proceedToCheckout(){_proceedToCheckout=asyncToGenerator_default()(function*(){shouldCancelReservations=!1;const checkoutHandler=getCheckoutHandlerForProvider(providerClass);if(!checkoutHandler){console.error(`No checkout handler found for provider ${providerClass}`);return}
const data=new FormData();data.append('provider',providerClass);data.append('attendee[optout]','1');data.append('tickets_tickets_ar','1');const selectedTickets=readTicketsFromSelection();data.append('tribe_tickets_saving_attendees','1');data.append('tribe_tickets_ar_data',JSON.stringify({tribe_tickets_tickets:selectedTickets,tribe_tickets_meta:[],tribe_tickets_post_id:postId}));const ok=yield checkoutHandler(data);if(!ok){console.error('Failed to proceed to checkout.')}
shouldCancelReservations=!0});return _proceedToCheckout.apply(this,arguments)}
function setExpireDate(dialogElement){var _dialogElement$node;const iframe=dialogElement?dialogElement===null||dialogElement===void 0?void 0:(_dialogElement$node=dialogElement.node)===null||_dialogElement$node===void 0?void 0:_dialogElement$node.querySelector('.tec-tickets-seating__iframe-container iframe.tec-tickets-seating__iframe'):null;if(!iframe){return}
iframe.src=iframe.src+'&expireDate='+new Date().getTime()}
function addModalEventListeners(){var _document$querySelect,_document$querySelect2;(_document$querySelect=document.querySelector('.tec-tickets-seating__modal .tec-tickets-seating__sidebar-control--cancel'))===null||_document$querySelect===void 0?void 0:_document$querySelect.addEventListener('click',closeModal);(_document$querySelect2=document.querySelector(confirmSelector))===null||_document$querySelect2===void 0?void 0:_document$querySelect2.addEventListener('click',proceedToCheckout);Object(external_tec_tickets_seating_frontend_session_.start)();const modal=window[objectName];if(!modal){return}
modal.on('hide',cancelReservations);modal.on('destroy',cancelReservations)}
function waitForModalElement(){return _waitForModalElement.apply(this,arguments)}
function _waitForModalElement(){_waitForModalElement=asyncToGenerator_default()(function*(){return new Promise(resolve=>{const check=()=>{if(window[objectName]){resolve(window[objectName])}
setTimeout(check,50)};check()})});return _waitForModalElement.apply(this,arguments)}
waitForModalElement().then(modalElement=>{modalElement.on('show',()=>{disableCheckout();bootstrapIframe(document);addModalEventListeners();setExpireDate(modalElement)})});window.tec=window.tec||{};window.tec.tickets=window.tec.tickets||{};window.tec.tickets.seating=window.tec.tickets.seating||{};window.tec.tickets.seating.frontend=window.tec.tickets.seating.frontend||{};window.tec.tickets.seating.frontend.ticketsBlock=_objectSpread(_objectSpread({},window.tec.tickets.seating.frontend.ticketsBlock||{}),{},{cancelReservations})}),"pJv/":(function(module,exports){module.exports=tec.tickets.seating.service.iframe}),"wRIV":(function(module,exports){module.exports=tec.tickets.seating.service.api})})